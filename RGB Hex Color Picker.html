<!DOCTYPE html>
<html lang="ja">

<head>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hex Color Picker</title>

  <style>
    * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    }
    body, html {
    width: 100%;
    height: 100%;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #f0f0f0;
    }
    .container {
    position: relative;
    width: 400px;
    height: 500px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    user-select: none;
    }
    .display {
    display: inline-flex;
    align-items: center;
    position: absolute;
    top: 31px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2rem;
    font-weight: bold;
    color: #333;
    z-index: 5;
    cursor: pointer;
    user-select: none;
    }
    #color-box {
    display: inline-flex;
    align-items: center;
    position: absolute;
    top: 17px;
    left: 50%;
    transform: translateX(-50%);
    width: 20%;
    height: 10px;
    box-shadow: 0 1px 6px rgba(22, 22, 22, 0.15);
    border-radius: 4px;
    background-color: #222; /* начальный цвет */
    }
    .columns {
    position: absolute;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    width: 90%;
    height: 380px;
    z-index: 1;
    }
    .column {
    flex: 1;
    margin: 0 5px;
    background-color: #222;
    border-radius: 4px;
    overflow-y: scroll;
    scrollbar-width: none; /* for Firefox */
    position: relative;
    scroll-snap-type: y mandatory;
    cursor: grab; /* меняем курсор */
    }
    .column:active {
    cursor: grabbing;
    }
    .column::-webkit-scrollbar {
    width: 0;
    height: 0;
    }
    .column .spacer {
    height: 170px; /* центрует 40px-высокую ячейку в 380px-контейнере */
    }
    .column-item {
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    color: #fff;
    font-size: 1rem;
    scroll-snap-align: center;
    user-select: none;
    }
    .column-item.selected {
    font-size: 1.2rem;
    }
    /* Рамка вокруг центральной выбранной ячейки */
    .selector-frame {
    position: absolute;
    top: calc(50% - 20px);
    left: 0;
    width: 100%;
    height: 40px;
    border: 3px solid #fff;
    background-color: rgba(255, 255, 255, 0.1);
    pointer-events: none;
    box-sizing: border-box;
    z-index: 2;
    }
  </style>

</head>

<body>

  <div class="container">
    <!-- Квадратик с цветом -->
    <div id="color-box"></div>
    <!-- Центральный дисплей: отображает собранный hex-код -->
    <div class="display" id="color-display">
      # <span id="hex-r">00</span> <span id="hex-g">00</span> <span id="hex-b">00</span>
    </div>

    <!-- Область с тремя колонками и селектором -->
    <div class="columns" id="columns-wrapper">
      <!-- Горизонтальная линия через выбранные ячейки -->
      <div class="highlight-line"></div>
      <!-- Рамка вокруг центральной выбранной ячейки -->
      <div class="selector-frame"></div>

      <div class="column" id="col-r">
        <div class="spacer"></div>
        <!-- Элементы заполняются через JS -->
      </div>
      <div class="column" id="col-g">
        <div class="spacer"></div>
      </div>
      <div class="column" id="col-b">
        <div class="spacer"></div>
      </div>
    </div>
  </div>

  <script>
    const hexValues = [
    'FF', 'EE', 'DD', 'CC', 'BB', 'AA', '99', '88', '77', '66', '55', '44', '33', '22', '11', '00'
    ];

    const SPACER_HEIGHT = 170;
    const ITEM_HEIGHT = 40;

    let selected = { r: '00', g: '00', b: '00' };

    const dragState = {
    isDragging: false,
    startY: 0,
    scrollStart: 0,
    column: null
    };

    function populateColumn(columnId, channel) {
    const column = document.getElementById(columnId);
    hexValues.forEach((val) => {
        const item = document.createElement('div');
        item.classList.add('column-item');
        item.textContent = val;
        let bgColor;
        switch (channel) {
        case 'r':
            bgColor = `#${val}0000`;
            break;
        case 'g':
            bgColor = `#00${val}00`;
            break;
        case 'b':
            bgColor = `#0000${val}`;
            break;
        }
        item.style.backgroundColor = bgColor;
        column.appendChild(item);
    });
    const bottomSpacer = document.createElement('div');
    bottomSpacer.classList.add('spacer');
    column.appendChild(bottomSpacer);

    column.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = e.deltaY > 0 ? ITEM_HEIGHT : -ITEM_HEIGHT;
        column.scrollBy({ top: delta, left: 0, behavior: 'smooth' });
    }, { passive: false });

    column.addEventListener('mousedown', (e) => {
        dragState.isDragging = true;
        dragState.startY = e.clientY;
        dragState.scrollStart = column.scrollTop;
        dragState.column = column;
        column.classList.add('dragging');
    });
    document.addEventListener('mousemove', (e) => {
        if (!dragState.isDragging || dragState.column !== column) return;
        const dy = e.clientY - dragState.startY;
        const newScroll = dragState.scrollStart - dy;
        const snapped = Math.round(newScroll / ITEM_HEIGHT) * ITEM_HEIGHT;
        dragState.column.scrollTop = snapped;
    });
    document.addEventListener('mouseup', () => {
        if (!dragState.isDragging) return;
        dragState.isDragging = false;
        if (dragState.column) dragState.column.classList.remove('dragging');
        dragState.column = null;
    });

    column.addEventListener('scroll', () => onScrollColumn(column, channel));
    }

    function onScrollColumn(columnElem, channel) {
    const rect = columnElem.getBoundingClientRect();
    const centerY = rect.top + rect.height / 2;
    const centerX = rect.left + rect.width / 2;
    const elemAtCenter = document.elementFromPoint(centerX, centerY);
    if (!elemAtCenter || !elemAtCenter.classList.contains('column-item')) return;

    columnElem.querySelectorAll('.column-item').forEach((el) => el.classList.remove('selected'));
    elemAtCenter.classList.add('selected');
    selected[channel] = elemAtCenter.textContent;
    updateDisplay();
    }

    function updateDisplay() {
    document.getElementById('hex-r').textContent = selected.r;
    document.getElementById('hex-g').textContent = selected.g;
    document.getElementById('hex-b').textContent = selected.b;
    const combined = `#${selected.r}${selected.g}${selected.b}`;
    const display = document.getElementById('color-display');

    const colorBox = document.getElementById('color-box');
    colorBox.style.backgroundColor = combined;
    }

    window.addEventListener('DOMContentLoaded', () => {
    populateColumn('col-r', 'r');
    populateColumn('col-g', 'g');
    populateColumn('col-b', 'b');

    ['col-r', 'col-g', 'col-b'].forEach((id) => {
        const col = document.getElementById(id);
        const targetIndex = hexValues.length - 1; // 15 for '00'
        const offsetTop = SPACER_HEIGHT + targetIndex * ITEM_HEIGHT;
        const scrollPos = offsetTop - (col.clientHeight / 2 - ITEM_HEIGHT / 2);
        col.scrollTop = scrollPos;
        onScrollColumn(col, id.charAt(id.length - 1));
    });

    document.getElementById('color-display').addEventListener('click', () => {
    const combined = `#${selected.r}${selected.g}${selected.b}`;
    navigator.clipboard.writeText(combined).then(() => {
        alert(`${combined} コピーしました！`);
        }).catch(() => {
        alert('コピーに失敗しました');
        });
        });
    });
  </script>

</body>

</html>